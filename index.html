<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8">
<title>Els éssers vius i la cèl·lula - Cicle Mitjà</title>

<style>
body{
    font-family: Arial, Helvetica, sans-serif;
    background-color:#f0f6fb;
    margin:0;
    padding:20px;
}

.page{
    display:none;
    max-width:900px;
    margin:auto;
    background:white;
    padding:30px;
    border-radius:10px;
    box-shadow:0 0 10px rgba(0,0,0,0.1);
}

.page.active{
    display:block;
}

h1,h2{
    color:#1b4f72;
}

button{
    padding:10px 15px;
    margin:5px;
    border:none;
    border-radius:5px;
    background:#2e86c1;
    color:white;
    font-size:15px;
    cursor:pointer;
}

button:hover{
    background:#21618c;
}

.controls{
    margin-top:20px;
    border-top:2px solid #ddd;
    padding-top:15px;
}

.audioBar{
    margin-top:15px;
}

input[type=range]{
    width:100%;
}
</style>
</head>
<body>

<h1 style="text-align:center;">ELS ÉSSERS VIUS I LA CÈL·LULA</h1>

<!-- PÀGINES -->

<div class="page active">
<h2>1. Què és un ésser viu?</h2>
<p>Un ésser viu és tot allò que neix, creix i es reprodueix.</p>
<p>Fa tres funcions vitals:</p>
<p><strong>Nutrició:</strong> obtenir energia.</p>
<p><strong>Relació:</strong> notar el que passa i reaccionar.</p>
<p><strong>Reproducció:</strong> tenir descendència.</p>
<div class="controls">
<button onclick="speakNormal()">Escoltar (velocitat normal)</button>
<button onclick="speakSlow()">Escoltar (velocitat lenta)</button>
<button onclick="prevPage()">Anterior</button>
<button onclick="nextPage()">Següent</button>
<div class="audioBar">
<button onclick="stopSpeech()">Parar</button>
<span id="time">0s / 0s</span>
<input type="range" id="progress" value="0" min="0" max="100">
</div>
</div>
</div>

<div class="page">
<h2>Preguntes</h2>
<p>1. Quina és una funció vital?</p>
<p>a) Dormir b) Nutrició c) Córrer</p>
<p>2. Què fa un ésser viu quan es relaciona?</p>
<p>a) Dorm b) Nota i respon c) No fa res</p>
<p><strong>Resposta curta:</strong> Escriu una funció vital.</p>
<div class="controls">
<button onclick="speakNormal()">Escoltar (velocitat normal)</button>
<button onclick="speakSlow()">Escoltar (velocitat lenta)</button>
<button onclick="prevPage()">Anterior</button>
<button onclick="nextPage()">Següent</button>
<div class="audioBar">
<button onclick="stopSpeech()">Parar</button>
<span id="time">0s / 0s</span>
<input type="range" id="progress" value="0" min="0" max="100">
</div>
</div>
</div>

<!-- Pots duplicar aquest patró per la resta de temes -->

<script>
let pages = document.querySelectorAll(".page");
let currentPage = 0;
let progress = document.getElementById("progress");
let timeDisplay = document.getElementById("time");

function showPage(index){
    pages[currentPage].classList.remove("active");
    currentPage = index;
    pages[currentPage].classList.add("active");
}

function nextPage(){
    if(currentPage < pages.length-1){
        showPage(currentPage+1);
    }
}

function prevPage(){
    if(currentPage > 0){
        showPage(currentPage-1);
    }
}

let utterance;
let totalTime = 0;
let interval;

function speakNormal(){
    speakText(1,false);
}

function speakSlow(){
    speakText(1,true);
}

function speakText(rate, slowMode){
    stopSpeech();
    let text = pages[currentPage].innerText;
    
    if(slowMode){
        let words = text.split(" ");
        let index = 0;
        function speakWord(){
            if(index < words.length){
                utterance = new SpeechSynthesisUtterance(words[index]);
                utterance.lang="ca-ES";
                speechSynthesis.speak(utterance);
                index++;
                setTimeout(speakWord,1000);
            }
        }
        speakWord();
    }else{
        utterance = new SpeechSynthesisUtterance(text);
        utterance.lang="ca-ES";
        utterance.rate=rate;
        speechSynthesis.speak(utterance);

        totalTime = text.split(" ").length/2;
        let current = 0;
        progress.value=0;
        interval = setInterval(()=>{
            current++;
            progress.value = (current/totalTime)*100;
            timeDisplay.innerText = Math.floor(current)+"s / "+Math.floor(totalTime)+"s";
            if(current>=totalTime){
                clearInterval(interval);
            }
        },1000);
    }
}

function stopSpeech(){
    speechSynthesis.cancel();
    clearInterval(interval);
    progress.value=0;
    timeDisplay.innerText="0s / 0s";
}

progress.addEventListener("input", function(){
    speechSynthesis.cancel();
});
</script>

</body>
</html>
